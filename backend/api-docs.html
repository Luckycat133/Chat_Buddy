<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Buddy API Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .endpoint {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            border-radius: 4px;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            font-size: 12px;
            margin-right: 10px;
        }
        .post { background: #28a745; }
        .get { background: #007bff; }
        .delete { background: #dc3545; }
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            border: 1px solid #dee2e6;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Chat Buddy API Documentation</h1>
        
        <div class="warning">
            <strong>⚠️ 重要提示:</strong> 请确保在请求头中包含 <code>Content-Type: application/json</code>
        </div>

        <h2>基础信息</h2>
        <p><strong>基础URL:</strong> <code>http://localhost:5001</code></p>
        <p><strong>跨域配置:</strong> 已启用，允许来自 <code>http://localhost:3001</code> 的请求</p>

        <h2>API端点</h2>

        <div class="endpoint">
            <h3><span class="method post">POST</span> /api/chat</h3>
            <p>发送消息到AI助手并获取回复</p>
            
            <h4>请求体:</h4>
            <pre>{
  "message": "你好，我是新用户",
  "userId": "user123"
}</pre>

            <h4>响应:</h4>
            <pre>{
  "message": {
    "role": "assistant",
    "content": "你好！很高兴认识你..."
  }
}</pre>
        </div>

        <div class="endpoint">
            <h3><span class="method get">GET</span> /api/conversation/:userId</h3>
            <p>获取指定用户的对话历史</p>
            
            <h4>示例:</h4>
            <pre>GET /api/conversation/user123</pre>

            <h4>响应:</h4>
            <pre>{
  "conversation": [
    {
      "role": "user",
      "content": "你好"
    },
    {
      "role": "assistant", 
      "content": "你好！有什么我可以帮你的吗？"
    }
  ]
}</pre>
        </div>

        <div class="endpoint">
            <h3><span class="method delete">DELETE</span> /api/reset/:userId</h3>
            <p>重置指定用户的对话历史和上下文</p>
            
            <h4>示例:</h4>
            <pre>DELETE /api/reset/user123</pre>

            <h4>响应:</h4>
            <pre>{
  "message": "Conversation reset successfully"
}</pre>
        </div>

        <div class="endpoint">
            <h3><span class="method post">POST</span> /api/configure</h3>
            <p>配置用户API设置</p>
            
            <h4>请求体:</h4>
            <pre>{
  "userId": "user123",
  "settings": {
    "apiKey": "your-api-key",
    "apiUrl": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite:generateContent",
    "provider": "gemini"
  }
}</pre>
        </div>

        <div class="endpoint">
            <h3><span class="method get">GET</span> /api/export/:userId</h3>
            <p>导出用户数据（对话历史和设置）</p>
            
            <h4>响应:</h4>
            <pre>{
  "userId": "user123",
  "conversation": [...],
  "settings": {...}
}</pre>
        </div>

        <div class="endpoint">
            <h3><span class="method post">POST</span> /api/import/:userId</h3>
            <p>导入用户数据</p>
            
            <h4>请求体:</h4>
            <pre>{
  "conversation": [...],
  "settings": {...}
}</pre>
        </div>

        <h2>错误处理</h2>
        <p>所有端点都可能返回以下错误响应：</p>
        <pre>{
  "error": "错误描述",
  "details": "详细错误信息（仅在开发环境显示）"
}</pre>

        <h2>速率限制</h2>
        <ul>
            <li>普通请求：每15分钟1000次</li>
            <li>API文档访问：每15分钟100次</li>
        </ul>

        <h2>支持的API提供商</h2>
        <ul>
            <li><strong>Gemini</strong>: Google Gemini API</li>
            <li><strong>OpenAI</strong>: OpenAI GPT API</li>
            <li><strong>Anthropic</strong>: Claude API</li>
            <li><strong>OpenRouter</strong>: 统一AI API网关</li>
            <li><strong>Groq</strong>: 高速推理API</li>
        </ul>
    </div>
</body>
</html>